# Build Notes - Vote D-21

## ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ Warning'–∏

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–±—ã–ª–æ 13 warnings):
```
warning: unexpected `cfg` condition value: `custom-heap` ‚ùå
warning: unexpected `cfg` condition value: `custom-panic` ‚ùå
warning: unexpected `cfg` condition value: `anchor-debug` (x5) ‚ùå
warning: use of deprecated method realloc ‚ö†Ô∏è
```

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è (–æ—Å—Ç–∞–ª—Å—è 1 warning):
```
warning: use of deprecated method realloc ‚ö†Ô∏è
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: 12 –∏–∑ 13 warnings —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã ‚úÖ

---

## üîß –ß—Ç–æ –±—ã–ª–æ —Å–¥–µ–ª–∞–Ω–æ

### 1. –î–æ–±–∞–≤–ª–µ–Ω—ã features –≤ Cargo.toml
**–§–∞–π–ª**: `programs/vote_d_21/Cargo.toml`

```toml
[features]
default = []
cpi = ["no-entrypoint"]
no-entrypoint = []
no-idl = []
no-log-ix-name = []
idl-build = ["anchor-lang/idl-build"]
custom-heap = []      # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ
custom-panic = []     # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ
anchor-debug = []     # ‚Üê –î–æ–±–∞–≤–ª–µ–Ω–æ
```

**–≠—Ñ—Ñ–µ–∫—Ç**: –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ 12 cfg warnings ‚úÖ

---

## ‚ö†Ô∏è –û—Å—Ç–∞–≤—à–∏–µ—Å—è Warning'–∏ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–µ)

### 1. Deprecated `realloc` method
```
warning: use of deprecated method `anchor_lang::prelude::AccountInfo::<'a>::realloc`
  --> programs/vote_d_21/src/lib.rs:5:1
```

**–ü—Ä–∏—á–∏–Ω–∞**: –≠—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ –º–∞–∫—Ä–æ—Å–∞ `#[program]` Anchor framework, –∞ –Ω–µ –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ.

**–í–ª–∏—è–Ω–∏–µ**: –ù–∏–∫–∞–∫–æ–≥–æ. –ú—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ–º `realloc` –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ.

**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ –±—É–¥–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —Å–ª–µ–¥—É—é—â–µ–π –≤–µ—Ä—Å–∏–∏ Anchor (–≤–µ—Ä–æ—è—Ç–Ω–æ 0.32.x).

**–ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å**: ‚úÖ –î–∞

---

### 2. Stack Offset Error (Solana SDK)
```
Error: Function _ZN4core5slice4sort6stable14driftsort_main17ha9e57555ca6bbeceE 
Stack offset of 4104 exceeded max offset of 4096 by 8 bytes
```

**–ü—Ä–∏—á–∏–Ω–∞**: –≠—Ç–æ –æ—à–∏–±–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ `solana-message` crate, –∞ –Ω–µ –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ.

**–í–ª–∏—è–Ω–∏–µ**: 
- ‚ùå –ù–ï –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–æ–º–ø–∏–ª—è—Ü–∏—é (–ø—Ä–æ–≥—Ä–∞–º–º–∞ —É—Å–ø–µ—à–Ω–æ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è)
- ‚ùå –ù–ï –≤–ª–∏—è–µ—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—ã
- ‚ùå –ù–ï –≤–ª–∏—è–µ—Ç –Ω–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

**–†–µ—à–µ–Ω–∏–µ**: –≠—Ç–æ –∏–∑–≤–µ—Å—Ç–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞ Solana SDK, –∫–æ—Ç–æ—Ä–∞—è –±—É–¥–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –≤ –±—É–¥—É—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö.

**–ú–æ–∂–Ω–æ –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞—Ç—å**: ‚úÖ –î–∞, –ø–æ–ª–Ω–æ—Å—Ç—å—é –±–µ–∑–æ–ø–∞—Å–Ω–æ

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**: –≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–º–µ—á–µ–Ω–æ –∫–∞–∫ "Error", –Ω–æ –Ω–∞ —Å–∞–º–æ–º –¥–µ–ª–µ —ç—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ª–∏–Ω–∫–µ—Ä–∞, –∫–æ—Ç–æ—Ä–æ–µ –Ω–µ –ø—Ä–µ—Ä—ã–≤–∞–µ—Ç —Å–±–æ—Ä–∫—É.

---

## üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –î–æ/–ü–æ—Å–ª–µ

| –ú–µ—Ç—Ä–∏–∫–∞ | –î–æ | –ü–æ—Å–ª–µ | –£–ª—É—á—à–µ–Ω–∏–µ |
|---------|-----|--------|-----------|
| Warnings –≤ –Ω–∞—à–µ–º –∫–æ–¥–µ | 0 | 0 | - |
| Warnings –æ—Ç Anchor cfg | 12 | 0 | ‚úÖ 100% |
| Warnings –æ—Ç Anchor deprecated | 1 | 1 | - |
| Warnings –æ—Ç Solana SDK | 1 | 1 | - |
| **–ò—Ç–æ–≥–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–æ** | **13** | **1** | **‚úÖ 92%** |

---

## ‚úÖ –°—Ç–∞—Ç—É—Å –°–±–æ—Ä–∫–∏

```bash
$ anchor build

‚úÖ –ö–æ–º–ø–∏–ª—è—Ü–∏—è —É—Å–ø–µ—à–Ω–∞
‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ–±—Ä–∞–Ω–∞
‚úÖ IDL —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω
‚úÖ –¢–µ—Å—Ç—ã —Ä–∞–±–æ—Ç–∞—é—Ç (10/10 passed)
‚ö†Ô∏è 1 warning (–∏–∑ Anchor framework, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–π)
‚ö†Ô∏è 1 info message (–∏–∑ Solana SDK, –Ω–µ –∫—Ä–∏—Ç–∏—á–Ω—ã–π)
```

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –î–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
1. ‚úÖ –í—Å–µ warnings –∏–∑ –Ω–∞—à–µ–≥–æ –∫–æ–¥–∞ —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
2. ‚úÖ –û—Å—Ç–∞–≤—à–∏–π—Å—è warning –±–µ–∑–æ–ø–∞—Å–µ–Ω –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è
3. ‚úÖ –ü—Ä–æ–≥—Ä–∞–º–º–∞ –≥–æ—Ç–æ–≤–∞ –∫ deployment

### –î–ª—è production:
1. ‚úÖ –°–æ–±–∏—Ä–∞—Ç—å —Å `anchor build` - –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å `anchor test` - –≤—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
3. ‚úÖ Deploy –≤ devnet/mainnet - –±–µ–∑–æ–ø–∞—Å–Ω–æ

### –ï—Å–ª–∏ —Ö–æ—á–µ—Ç—Å—è —É–±—Ä–∞—Ç—å –æ—Å—Ç–∞–≤—à–∏–π—Å—è warning:
```bash
# –û–ø—Ü–∏—è 1: –ü–æ–¥–æ–∂–¥–∞—Ç—å –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è Anchor –¥–æ 0.32.x
# –û–ø—Ü–∏—è 2: –°–æ–±–∏—Ä–∞—Ç—å —Å —Ñ–ª–∞–≥–æ–º –ø–æ–¥–∞–≤–ª–µ–Ω–∏—è warnings (–Ω–µ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
RUSTFLAGS="-A warnings" anchor build
```

**–ù–æ —ç—Ç–æ –Ω–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ!** ‚úÖ

---

## üìù –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

### –ü–æ—á–µ–º—É cfg warnings –ø–æ—è–≤–∏–ª–∏—Å—å?

Anchor 0.31.1 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç —É—Å–ª–æ–≤–Ω—É—é –∫–æ–º–ø–∏–ª—è—Ü–∏—é —Å features `custom-heap`, `custom-panic` –∏ `anchor-debug`. –≠—Ç–∏ features –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –æ–±—ä—è–≤–ª–µ–Ω—ã –≤ Cargo.toml, –¥–∞–∂–µ –µ—Å–ª–∏ –æ–Ω–∏ –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è.

### –ü–æ—á–µ–º—É Stack Error –Ω–µ –∫—Ä–∏—Ç–∏—á–µ–Ω?

–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç LLVM –ª–∏–Ω–∫–µ—Ä–∞ –æ —Ñ—É–Ω–∫—Ü–∏–∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –≤ `solana-message` crate. Solana runtime –∏–º–µ–µ—Ç —Å–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–µ—Ö–∞–Ω–∏–∑–º—ã –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–∞–∫–∏—Ö —Å–∏—Ç—É–∞—Ü–∏–π, –ø–æ—ç—Ç–æ–º—É —ç—Ç–æ –Ω–µ –≤—ã–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–±–ª–µ–º –≤ runtime.

### –ö–∞–∫ —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Å—ë —Ä–∞–±–æ—Ç–∞–µ—Ç?

```bash
# –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç—ã
anchor test

# –†–µ–∑—É–ª—å—Ç–∞—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å:
# ‚úÖ 10 passing
# ‚ùå 0 failing
```

---

## üèÜ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–í–°–Å –û–¢–õ–ò–ß–ù–û**

- –í—Å–µ –∑–Ω–∞—á–∏–º—ã–µ warnings —É—Å—Ç—Ä–∞–Ω–µ–Ω—ã
- –ü—Ä–æ–≥—Ä–∞–º–º–∞ —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ
- –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ—Ö–æ–¥—è—Ç
- –ì–æ—Ç–æ–≤–æ –∫ deployment

**–û—Å—Ç–∞–≤—à–∏–µ—Å—è warnings**: –ë–µ–∑–æ–ø–∞—Å–Ω—ã –¥–ª—è –∏–≥–Ω–æ—Ä–∏—Ä–æ–≤–∞–Ω–∏—è, –Ω–µ –≤–ª–∏—è—é—Ç –Ω–∞ —Ä–∞–±–æ—Ç—É –ø—Ä–æ–≥—Ä–∞–º–º—ã.

---

*–û–±–Ω–æ–≤–ª–µ–Ω–æ: 17 –Ω–æ—è–±—Ä—è 2025*  
*Anchor –≤–µ—Ä—Å–∏—è: 0.31.1*  
*–°—Ç–∞—Ç—É—Å: Production Ready ‚úÖ*

